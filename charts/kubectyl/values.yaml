# Default values for Kubectyl.
# This is a YAML-formatted file.
# Declare name/value pairs to be passed into your templates.
# name: value

# Usage:
# - Set database.type to 'mariadb' (default) or 'postgres'
# - If using postgres, fill in postgres.externalHost and postgres.auth.*
# - If using postgres, mariadb.create should be set to false (can be handled in your templates)
# - The Helm template will set Laravel's DB_CONNECTION and SESSION_DRIVER accordingly

## Database selection for Laravel DB_CONNECTION and session driver
## Set to 'mariadb' (default) or 'postgres'
database:
  type: mariadb  # Options: mariadb, postgres

## Overrides for generated resource names
# See templates/_helpers.tpl
global:
  timezone: UTC

ingress:
  class: nginx
  panel: panel.example.com
  kuber: kuber.example.com
  tls:
    create: true
    clusterIssuer: letsencrypt-prod
    secretName: ""
  annotations: {}

panel:
  image: quay.io/kubectyl/panel:develop
  imagePullPolicy: "Always"
  storageClass: ""
  existingVolumeClaim: ""
  email: abc@example.com
  serviceAnnotations: {}
  statefulSetAnnotations: {}

kuber:
  image: quay.io/kubectyl/kuber:develop
  imagePullPolicy: "Always"
  replicaCount: 0
  serviceAnnotations: {}
  deploymentAnnotations: {}
  initContainers:
    - name: tmp
      image: busybox
      command: ["sh", "-c", "cp /tmp/kubectyl/config.yml /etc/kubectyl/config.yml && chmod 777 /etc/kubectyl/config.yml"]
      volumeMounts:
        - name: config
          mountPath: "/tmp/kubectyl"
        - name: tmp
          mountPath: "/etc/kubectyl"
    - name: port
      image: mikefarah/yq
      command: ["sh", "-c", "yq --inplace '.api.port = 80' /etc/kubectyl/config.yml"]
      volumeMounts:
        - name: tmp
          mountPath: "/etc/kubectyl"
    - name: disable
      image: mikefarah/yq
      command: ["sh", "-c", "yq --inplace '.api.ssl.enabled = false' /etc/kubectyl/config.yml"]
      volumeMounts:
        - name: tmp
          mountPath: "/etc/kubectyl"
    - name: sftp-server
      image: mikefarah/yq
      command: ["sh", "-c", "yq --inplace '.system.sftp.sftp_image = \"ghcr.io/raefon/sftp-server:latest\"' /etc/kubectyl/config.yml"]
      volumeMounts:
        - name: tmp
          mountPath: "/etc/kubectyl"

# MariaDB configuration (default)
# If using Postgres, mariadb.create will be set to false in your templates
mariadb:
  # This should be set to false if database.type is 'postgres'
  create: true
  global:
    storageClass: ""
  externalHost: ""
  volumePermissions:
    enabled: true
  image:
    debug: true
  auth:
    database: panel
    username: kubectyl
    password: SecretPassword
    rootPassword: SuperSecretPassword
  primary:
    persistence:
      size: 1Gi
  secondary:
    replicaCount: 0

# External Postgres configuration (used if database.type is 'postgres')
postgres:
  # No create flag, always external
  externalHost: ""
  auth:
    database: panel
    username: kubectyl
    password: SecretPassword
    # Optionally add superuserPassword if needed

redis:
  create: true
  global:
    storageClass: ""
  externalHost: ""
  auth:
    enabled: false
    password: ""
  master:
    persistence:
      size: 1Gi
  replica:
    replicaCount: 0
  sentinel:
    enabled: false

serviceAccount:
  create: true
  name: ""
